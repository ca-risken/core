syntax = "proto3";

package core.organization_iam;
option go_package = "github.com/ca-risken/core/proto/organization_iam";

import "organization_iam/entity.proto";
import "validate/validate.proto";

message ListOrganizationAccessTokenRequest {
  uint32 organization_id = 1 [ (validate.rules).uint32.gt = 0 ]; // Required
  string name = 2 [ (validate.rules).string.max_len = 64 ];
  uint32 access_token_id = 3;
}

message ListOrganizationAccessTokenResponse {
  repeated OrganizationAccessToken access_token = 1;
}

message PutOrganizationAccessTokenRequest {
  uint32 organization_id = 1 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 access_token_id = 2;
  string plain_text_token = 3;
  string name = 4 [ (validate.rules).string = {min_len : 1, max_len : 64} ];
  string description = 5 [ (validate.rules).string.max_len = 255 ];
  int64 expired_at = 6
      [ (validate.rules).int64 = {gte : 0, lte : 253402268399} ];
  uint32 last_updated_user_id = 7
      [ (validate.rules).uint32.gt = 0 ]; // Required
}

message PutOrganizationAccessTokenResponse {
  OrganizationAccessToken access_token = 1;
}

message DeleteOrganizationAccessTokenRequest {
  uint32 organization_id = 1 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 access_token_id = 2 [ (validate.rules).uint32.gt = 0 ]; // Required
}

message AuthenticateOrganizationAccessTokenRequest {
  uint32 organization_id = 1 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 access_token_id = 2 [ (validate.rules).uint32.gt = 0 ]; // Required
  string plain_text_token = 3
      [ (validate.rules).string = {min_len : 1} ]; // Required
}

message AuthenticateOrganizationAccessTokenResponse {
  OrganizationAccessToken access_token = 1;
}

message AttachOrganizationAccessTokenRoleRequest {
  uint32 organization_id = 1 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 access_token_id = 2 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 role_id = 3 [ (validate.rules).uint32.gt = 0 ];         // Required
}

message AttachOrganizationAccessTokenRoleResponse {
  OrganizationAccessTokenRole access_token_role = 1;
}

message DetachOrganizationAccessTokenRoleRequest {
  uint32 organization_id = 1 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 access_token_id = 2 [ (validate.rules).uint32.gt = 0 ]; // Required
  uint32 role_id = 3 [ (validate.rules).uint32.gt = 0 ];         // Required
}
